{% extends "base.html" %}

{% block title %}Design System - OpenAver{% endblock %}

{% block extra_css %}
<link href="/static/css/pages/design-system.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="ds-layout">
    <!-- 左側 TOC 側欄 -->
    <nav class="ds-toc">
        <span class="ds-toc-title">Contents</span>
        <a href="#colors">Colors & Typography</a>
        <a href="#fluent">Fluent Tokens</a>
        <a href="#buttons">Buttons</a>
        <a href="#forms">Form Controls</a>
        <a href="#cards">Cards</a>
        <a href="#av-cards">AV Card Variants</a>
        <a href="#file-components">File Components</a>
        <a href="#drag-overlay">Search Drag Overlay</a>
        <a href="#progress">Progress & Feedback</a>
        <a href="#navigation">Navigation</a>
        <a href="#rotating-border">Rotating Border</a>
        <a href="#feedback">Feedback</a>
    </nav>

    <!-- 右側內容 -->
    <div class="ds-content">
        <!-- 頁面標題 -->
        <header class="ds-header">
            <h1>OpenAver Design System</h1>
            <p class="ds-subtitle">DaisyUI + Fluent Design 2 元件庫</p>
        </header>

        <!-- 區塊 1: Colors & Typography (glass 樣式) -->
        <section id="colors" class="ds-section glass">
            <h2>Colors & Typography</h2>

            <!-- 主題色盤（儀表板化） -->
            <div class="ds-subsection">
                <h3>Theme Colors</h3>
                <div class="ds-color-grid">
                    <div class="ds-color-swatch" style="background: var(--bg-body);">
                        <div class="ds-color-info">
                            <span class="ds-color-name">--bg-body</span>
                            <code class="ds-color-hex" data-var="--bg-body"></code>
                            <span class="ds-color-usage">Page background</span>
                        </div>
                    </div>
                    <div class="ds-color-swatch" style="background: var(--bg-card);">
                        <div class="ds-color-info">
                            <span class="ds-color-name">--bg-card</span>
                            <code class="ds-color-hex" data-var="--bg-card"></code>
                            <span class="ds-color-usage">Card surfaces</span>
                        </div>
                    </div>
                    <div class="ds-color-swatch" style="background: var(--bg-sidebar);">
                        <div class="ds-color-info">
                            <span class="ds-color-name">--bg-sidebar</span>
                            <code class="ds-color-hex" data-var="--bg-sidebar"></code>
                            <span class="ds-color-usage">Navigation sidebar</span>
                        </div>
                    </div>
                    <div class="ds-color-swatch" style="background: var(--accent);">
                        <div class="ds-color-info">
                            <span class="ds-color-name">--accent</span>
                            <code class="ds-color-hex" data-var="--accent"></code>
                            <span class="ds-color-usage">Primary actions, links</span>
                        </div>
                    </div>
                    <div class="ds-color-swatch" style="background: var(--accent-red);">
                        <div class="ds-color-info">
                            <span class="ds-color-name">--accent-red</span>
                            <code class="ds-color-hex" data-var="--accent-red"></code>
                            <span class="ds-color-usage">Destructive actions</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 文字色 -->
            <div class="ds-subsection">
                <h3>Text Colors</h3>
                <div class="ds-text-samples">
                    <p><span style="color: var(--text-primary); font-weight: 600;">Primary Text</span> <code style="color: var(--text-muted); font-size: 0.85rem;">(--text-primary)</code></p>
                    <p><span style="color: var(--text-secondary);">Secondary Text</span> <code style="color: var(--text-muted); font-size: 0.85rem;">(--text-secondary)</code></p>
                    <p><span style="color: var(--text-muted);">Muted Text</span> <code style="color: var(--text-muted); font-size: 0.85rem;">(--text-muted)</code></p>
                </div>
            </div>

            <!-- 字型等級 -->
            <div class="ds-subsection">
                <h3>Typography Scale</h3>
                <div class="ds-typography">
                    <h1>Heading 1 - Space Grotesk 700</h1>
                    <h2>Heading 2 - Space Grotesk 600</h2>
                    <h3>Heading 3 - Plus Jakarta Sans 600</h3>
                    <h4>Heading 4 - Plus Jakarta Sans 500</h4>
                    <p>Body Text - Plus Jakarta Sans 400, 1rem/1.5</p>
                    <small>Small Text - 0.875rem</small>
                </div>
            </div>
        </section>

        <!-- 區塊 2: Fluent Design Tokens (accent-bar 樣式) -->
        <section id="fluent" class="ds-section accent-bar">
            <h2>Fluent Design Tokens</h2>

            <!-- 圓角展示 -->
            <div class="ds-subsection">
                <h3>Border Radius</h3>
                <div class="ds-radius-grid">
                    <div class="ds-radius-item fluent-rounded-sm">
                        <span>sm (2px)</span>
                    </div>
                    <div class="ds-radius-item fluent-rounded-md">
                        <span>md (4px)</span>
                    </div>
                    <div class="ds-radius-item fluent-rounded-lg">
                        <span>lg (8px)</span>
                    </div>
                    <div class="ds-radius-item fluent-rounded-xl">
                        <span>xl (12px)</span>
                    </div>
                </div>
            </div>

            <!-- 陰影展示 -->
            <div class="ds-subsection">
                <h3>Elevation (Shadow)</h3>
                <div class="ds-shadow-grid">
                    <div class="ds-shadow-item fluent-shadow-2">shadow-2</div>
                    <div class="ds-shadow-item fluent-shadow-4">shadow-4</div>
                    <div class="ds-shadow-item fluent-shadow-8">shadow-8</div>
                    <div class="ds-shadow-item fluent-shadow-16">shadow-16</div>
                </div>
                <p class="ds-note">Light/Dark 模式下陰影深度自動調整</p>
            </div>

            <!-- 毛玻璃效果 -->
            <div class="ds-subsection">
                <h3>Acrylic (Blur)</h3>
                <div class="ds-acrylic-demo">
                    <div class="ds-acrylic-bg">
                        <img src="/static/img/demo/sone-103.jpg" alt="背景">
                    </div>
                    <div class="ds-acrylic-overlay fluent-acrylic">
                        <span>.fluent-acrylic</span>
                        <code>blur: 30px, saturate: 140%</code>
                    </div>
                </div>
            </div>

            <!-- 動畫時長 -->
            <div class="ds-subsection">
                <h3>Motion Duration</h3>
                <div class="ds-duration-list">
                    <div class="ds-duration-item">
                        <span class="ds-duration-name">ultra-fast</span>
                        <span class="ds-duration-value">50ms</span>
                    </div>
                    <div class="ds-duration-item">
                        <span class="ds-duration-name">faster</span>
                        <span class="ds-duration-value">83ms</span>
                    </div>
                    <div class="ds-duration-item">
                        <span class="ds-duration-name">fast</span>
                        <span class="ds-duration-value">167ms</span>
                    </div>
                    <div class="ds-duration-item">
                        <span class="ds-duration-name">normal</span>
                        <span class="ds-duration-value">250ms</span>
                    </div>
                    <div class="ds-duration-item">
                        <span class="ds-duration-name">slow</span>
                        <span class="ds-duration-value">300ms</span>
                    </div>
                    <div class="ds-duration-item">
                        <span class="ds-duration-name">slower</span>
                        <span class="ds-duration-value">400ms</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- 區塊 3: Buttons (glass 樣式) -->
        <section id="buttons" class="ds-section glass">
            <h2>Buttons</h2>

            <!-- DaisyUI 按鈕 -->
            <div class="ds-subsection">
                <h3>DaisyUI Buttons</h3>
                <div class="ds-button-row">
                    <button class="btn btn-primary">Primary</button>
                    <button class="btn btn-secondary">Secondary</button>
                    <button class="btn btn-accent">Accent</button>
                    <button class="btn btn-ghost">Ghost</button>
                    <button class="btn btn-link">Link</button>
                </div>
                <div class="ds-button-row">
                    <button class="btn btn-outline btn-primary">Outline</button>
                    <button class="btn btn-primary btn-sm">Small</button>
                    <button class="btn btn-primary btn-lg">Large</button>
                    <button class="btn btn-primary" disabled>Disabled</button>
                </div>
            </div>

            <!-- Bootstrap 按鈕（過渡期保留） -->
            <div class="ds-subsection">
                <h3>Bootstrap Buttons (Legacy)</h3>
                <div class="ds-button-row">
                    <button class="btn btn-primary">Primary</button>
                    <button class="btn btn-outline-primary">Outline</button>
                    <button class="btn btn-outline-secondary">Secondary</button>
                    <button class="btn btn-outline-danger">Danger</button>
                    <button class="btn btn-success">Success</button>
                </div>
            </div>

            <!-- 自訂按鈕 -->
            <div class="ds-subsection">
                <h3>Custom Buttons</h3>
                <div class="ds-button-row ds-button-row-dark">
                    <button class="btn-icon"><i class="bi bi-search"></i></button>
                    <button class="btn-icon active"><i class="bi bi-arrow-right"></i></button>
                    <button class="btn-glass">Glass Button</button>
                </div>
                <div class="ds-button-row">
                    <button class="btn-hero btn-hero-primary">
                        <i class="bi bi-play-fill"></i> Hero Primary
                    </button>
                    <button class="btn-hero btn-hero-secondary">
                        <i class="bi bi-clipboard"></i> Hero Secondary
                    </button>
                </div>
            </div>
        </section>

        <!-- 區塊 4: Form Controls (accent-bar 樣式) -->
        <section id="forms" class="ds-section accent-bar">
            <h2>Form Controls</h2>

            <div class="ds-subsection">
                <h3>Input Fields</h3>
                <div class="ds-form-grid">
                    <div class="ds-form-item">
                        <label class="form-label">Text Input</label>
                        <input type="text" class="form-control" placeholder="輸入文字...">
                    </div>
                    <div class="ds-form-item">
                        <label class="form-label">Small Input</label>
                        <input type="text" class="form-control form-control-sm" placeholder="小型輸入框">
                    </div>
                    <div class="ds-form-item">
                        <label class="form-label">Select</label>
                        <select class="form-select">
                            <option>選項 1</option>
                            <option>選項 2</option>
                            <option>選項 3</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="ds-subsection">
                <h3>Spotlight Search</h3>
                <div class="spotlight-search" style="max-width: 500px;">
                    <i class="bi bi-search search-icon-left"></i>
                    <input type="text" placeholder="搜尋番號、女優或拖入檔案...">
                    <div class="search-actions-right">
                        <button class="btn-icon"><i class="bi bi-x-lg"></i></button>
                        <button class="btn-icon active"><i class="bi bi-arrow-right"></i></button>
                    </div>
                </div>
            </div>

            <div class="ds-subsection">
                <h3>Checkbox & Toggle</h3>
                <div class="ds-form-row">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="check1" checked>
                        <label class="form-check-label" for="check1">Checkbox</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="switch1" checked>
                        <label class="form-check-label" for="switch1">Toggle Switch</label>
                    </div>
                </div>
            </div>
        </section>

        <!-- 區塊 5: Cards (glass 樣式) -->
        <section id="cards" class="ds-section glass">
            <h2>Cards</h2>

            <div class="ds-subsection">
                <h3>Bootstrap Card (Legacy)</h3>
                <div class="card" style="max-width: 300px;">
                    <div class="card-header">Card Header</div>
                    <div class="card-body">
                        <h5 class="card-title">Card Title</h5>
                        <p class="card-text">Card content goes here.</p>
                    </div>
                </div>
            </div>

            <div class="ds-subsection">
                <h3>Fluent Card</h3>
                <div class="fluent-card" style="max-width: 300px; padding: 1rem; background: var(--bg-card);">
                    <h5>Fluent Card</h5>
                    <p style="color: var(--text-secondary);">12px 圓角 + shadow-4，hover 時 shadow-8</p>
                </div>
            </div>

            <div class="ds-subsection">
                <h3>Gallery Card</h3>
                <div class="gallery-card ds-gallery-card" style="max-width: 280px;">
                    <div class="gallery-card-img">
                        <img src="/static/img/demo/mide-974.jpg" alt="封面">
                        <div class="gallery-card-actions">
                            <button class="btn-glass">查看</button>
                            <button class="btn-glass">編輯</button>
                        </div>
                    </div>
                    <div class="gallery-card-footer">
                        <div class="gallery-card-title">作品標題範例</div>
                        <div class="gallery-card-meta">
                            <span class="gallery-card-num">MIDE-974</span>
                            <span>2024-01-01</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 區塊 6: AV Card Variants（重點，accent-bar 樣式）-->
        <section id="av-cards" class="ds-section accent-bar">
            <h2>AV Card Variants</h2>
            <p class="ds-note">3 種核心卡片變體用於不同場景，統一使用 Fluent Design tokens</p>

            <!-- Preview 變體（網格卡片） -->
            <div class="ds-subsection">
                <h3>1. Preview（網格封面）</h3>
                <p class="ds-desc">用於 Gallery 網格展示，強調封面視覺。統一尺寸網格佈局</p>
                <div class="ds-card-demo ds-card-mosaic">
                    <!-- 大卡 (featured) -->
                    <div class="av-card-preview featured">
                        <div class="av-card-preview-img">
                            <img src="/static/img/demo/sone-103.jpg" alt="cover">
                            <div class="av-card-preview-overlay">
                                <button class="btn-glass"><i class="bi bi-eye"></i></button>
                                <button class="btn-glass"><i class="bi bi-folder-plus"></i></button>
                            </div>
                            <span class="av-card-preview-badge">HD</span>
                        </div>
                        <div class="av-card-preview-footer">
                            <span class="av-num">SONE-103</span>
                            <span class="av-actress">女優名</span>
                        </div>
                    </div>
                    <!-- 小卡 1 -->
                    <div class="av-card-preview">
                        <div class="av-card-preview-img">
                            <img src="/static/img/demo/mide-974.jpg" alt="cover">
                            <span class="av-card-preview-badge local">本地</span>
                        </div>
                        <div class="av-card-preview-footer">
                            <span class="av-num">MIDE-974</span>
                            <span class="av-actress">女優名</span>
                        </div>
                    </div>
                    <!-- 小卡 2 -->
                    <div class="av-card-preview">
                        <div class="av-card-preview-img">
                            <img src="/static/img/demo/fc2-1723984.jpg" alt="cover">
                            <span class="av-card-preview-badge">FC2</span>
                        </div>
                        <div class="av-card-preview-footer">
                            <span class="av-num">FC2-PPV-1723984</span>
                            <span class="av-actress">素人</span>
                        </div>
                    </div>
                </div>
                <pre class="ds-code"><code>.av-card-preview {
  border-radius: var(--fluent-radius-xl);
  box-shadow: var(--fluent-shadow-4);
  overflow: hidden;
}
.av-card-preview:hover {
  box-shadow: 0 0 0 2px var(--accent), 0 0 20px rgba(90, 200, 250, 0.2);
  transform: translateY(-6px);
}</code></pre>
            </div>

            <!-- Full 變體 -->
            <div class="ds-subsection">
                <h3>2. Full（詳細頁面）</h3>
                <p class="ds-desc">用於搜尋結果詳情，左右分區佈局</p>
                <div class="ds-card-demo">
                    <div class="av-card-full">
                        <div class="av-card-full-cover">
                            <img src="/static/img/demo/cawd-441.jpg" alt="full cover">
                        </div>
                        <div class="av-card-full-info">
                            <div class="av-card-full-header">
                                <h4 class="av-num">CAWD-441</h4>
                                <span class="local-badge">本地</span>
                            </div>
                            <div class="av-card-full-body">
                                <div class="info-row">
                                    <span class="info-label">演員</span>
                                    <span class="info-value">女優名稱</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">發行日期</span>
                                    <span class="info-value">2024-01-15</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">片商</span>
                                    <span class="info-value">Kawaii</span>
                                </div>
                            </div>
                            <div class="av-card-full-footer">
                                <span class="info-label">標題</span>
                                <p class="info-value">作品標題範例，可能很長需要換行顯示</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Compact 變體 -->
            <div class="ds-subsection">
                <h3>3. Compact（檔案列表行）</h3>
                <p class="ds-desc">用於批次處理的檔案列表，單行緊湊</p>
                <div class="ds-card-demo">
                    <div class="av-card-compact">
                        <i class="bi bi-file-earmark-play"></i>
                        <span class="av-filename">SONE-103.mp4</span>
                        <span class="av-num">SONE-103</span>
                        <span class="av-status searched"><i class="bi bi-check"></i> 已搜尋</span>
                        <button class="btn btn-sm btn-outline-primary">產生</button>
                    </div>
                    <div class="av-card-compact">
                        <i class="bi bi-file-earmark-play"></i>
                        <span class="av-filename">IPZZ-001_uncensored.mp4</span>
                        <span class="av-num">IPZZ-001</span>
                        <span class="av-status pending">待搜尋</span>
                        <button class="btn btn-sm btn-outline-secondary">搜尋</button>
                    </div>
                    <div class="av-card-compact active">
                        <i class="bi bi-file-earmark-play"></i>
                        <span class="av-filename">FC2-PPV-1723984.mp4</span>
                        <span class="av-num">FC2-PPV-1723984</span>
                        <span class="av-status local"><i class="bi bi-folder-check"></i> 本地</span>
                        <button class="btn btn-sm btn-success">完成</button>
                    </div>
                </div>
                <pre class="ds-code"><code>.av-card-compact {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem;
  border-radius: var(--fluent-radius-md);
}
.av-card-compact.active {
  background: var(--border-light);
}</code></pre>
            </div>
        </section>

        <!-- 區塊 7: File Components (glass 樣式) -->
        <section id="file-components" class="ds-section glass">
            <h2>File Components</h2>
            <p class="ds-note">檔案操作相關元件，用於 Search 和 Gallery 頁面</p>

            <!-- File List Section -->
            <div class="ds-subsection">
                <h3>File List Section</h3>
                <p class="ds-desc">檔案列表項目，顯示檔案資訊和操作按鈕，支援 hover 和 active 狀態</p>
                <div class="ds-card-demo">
                    <div class="file-list-section" style="max-width: 600px;">
                        <div class="file-list-header">
                            <span style="font-size: 0.9rem; font-weight: 600; color: var(--text-primary);">檔案列表</span>
                            <span style="font-size: 0.8rem; color: var(--text-secondary);">3 個檔案</span>
                        </div>
                        <div class="file-item">
                            <i class="bi bi-file-earmark-play file-icon"></i>
                            <span class="file-name">SONE-103.mp4</span>
                            <span class="file-status">已搜尋</span>
                            <button class="btn btn-sm btn-outline-primary btn-scrape-single">查看</button>
                        </div>
                        <div class="file-item active">
                            <i class="bi bi-file-earmark-play file-icon"></i>
                            <span class="file-name">MIDE-974_HD.mp4</span>
                            <span class="file-status">已搜尋</span>
                            <button class="btn btn-sm btn-outline-primary btn-scrape-single">查看</button>
                        </div>
                        <div class="file-item">
                            <i class="bi bi-file-earmark-play file-icon"></i>
                            <span class="file-name">FC2-PPV-1723984.mp4</span>
                            <span class="file-status" style="color: var(--text-muted);">待搜尋</span>
                            <button class="btn btn-sm btn-outline-secondary btn-scrape-single">搜尋</button>
                        </div>
                    </div>
                </div>
                <pre class="ds-code"><code>.file-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
}
.file-item.active {
  background: var(--border-light);
  color: var(--accent);
  font-weight: 600;
}</code></pre>
            </div>

            <!-- Drag Overlay -->
            <div class="ds-subsection" id="drag-overlay">
                <h3>Drag Overlay (Search 彈窗)</h3>
                <p class="ds-desc">拖曳檔案時的全螢幕覆蓋層，毛玻璃效果 + 大圖示提示，支援主題跟隨</p>

                <!-- 示範容器：模擬實際效果 -->
                <div class="ds-card-demo" style="position: relative; height: 300px; overflow: hidden; border-radius: var(--fluent-radius-xl);">
                    <!-- 背景圖片 -->
                    <img src="/static/img/demo/sone-103.jpg" alt="background"
                         style="position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover;">

                    <!-- Drag Overlay（使用 .active class） -->
                    <div class="drag-overlay active" style="position: absolute; inset: 0; border-radius: var(--fluent-radius-xl);">
                        <div class="drag-overlay-content">
                            <i class="bi bi-file-earmark-arrow-up"></i>
                            <p>拖入檔案或資料夾</p>
                        </div>
                    </div>
                </div>

                <!-- 技術說明 -->
                <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-body); border-radius: var(--fluent-radius-lg); border: 1px solid var(--border-light);">
                    <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">
                        <strong style="color: var(--text-primary);">主題適配：</strong>
                        背景色 <code>oklch(var(--b1) / 0.6)</code>、文字色 <code>oklch(var(--bc))</code> 自動跟隨 DaisyUI 主題
                    </p>
                </div>

                <pre class="ds-code"><code>&lt;div class="drag-overlay active"&gt;
  &lt;div class="drag-overlay-content"&gt;
    &lt;i class="bi bi-file-earmark-arrow-up"&gt;&lt;/i&gt;
    &lt;p&gt;拖入檔案或資料夾&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
            </div>

            <!-- Folder Item -->
            <div class="ds-subsection">
                <h3>Folder Item</h3>
                <p class="ds-desc">Gallery 頁的資料夾列表項目，顯示路徑和移除按鈕</p>
                <div class="ds-card-demo">
                    <div style="max-width: 600px; background: var(--bg-card); border-radius: 12px; overflow: hidden;">
                        <div class="folder-item">
                            <i class="bi bi-folder folder-icon"></i>
                            <span class="folder-path">/Users/username/Videos/AV</span>
                            <button class="btn btn-sm btn-outline-danger btn-remove">移除</button>
                        </div>
                        <div class="folder-item">
                            <i class="bi bi-folder folder-icon"></i>
                            <span class="folder-path">D:\Downloads\JAV\Uncensored</span>
                            <button class="btn btn-sm btn-outline-danger btn-remove">移除</button>
                        </div>
                    </div>
                </div>
                <pre class="ds-code"><code>.folder-item {
  display: flex;
  align-items: center;
  padding: 0.875rem 1.25rem;
  gap: 0.75rem;
  border-bottom: 1px solid var(--border-light);
}
.folder-item:hover {
  background: var(--bg-body);
}
.folder-item:hover .btn-remove {
  opacity: 1;
}</code></pre>
            </div>
        </section>

        <!-- 區塊 8: Progress & Feedback (accent-bar 樣式) -->
        <section id="progress" class="ds-section accent-bar">
            <h2>Progress & Feedback</h2>
            <p class="ds-note">進度顯示和即時回饋元件</p>

            <!-- Progress Indicator -->
            <div class="ds-subsection">
                <h3>Progress Indicator</h3>
                <p class="ds-desc">Search 頁的搜尋進度顯示，跟隨主題顯示（wireframe: 淺底深字 / dim: 深底淺字）</p>
                <div class="ds-card-demo">
                    <div class="search-progress" style="max-width: 500px; margin: 0 auto;">
                        <div class="progress-container">
                            <div class="progress-header">
                                <span class="progress-status">搜尋中</span>
                            </div>
                            <div class="progress-log">
                                正在搜尋 SONE-103...
                            </div>
                            <div class="detail-progress show">
                                <div class="detail-bar" style="width: 65%;"></div>
                                <span class="detail-text">65 / 100</span>
                            </div>
                        </div>
                    </div>
                </div>
                <pre class="ds-code"><code>.search-progress {
  display: flex;
  align-items: center;
  justify-content: center;
}
.progress-log::before {
  content: '';
  width: 8px;
  height: 8px;
  border: 2px solid rgba(96, 165, 250, 0.3);
  border-top-color: #60a5fa;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}</code></pre>
            </div>

            <!-- Mini Terminal -->
            <div class="ds-subsection">
                <h3>Mini Terminal</h3>
                <p class="ds-desc">Gallery 頁的產生進度日誌視窗，Terminal 風格輸出</p>
                <div class="ds-card-demo">
                    <div class="mini-terminal" style="max-width: 500px;">
                        <div class="mini-terminal-header">
                            <span class="title">產生進度</span>
                        </div>
                        <div class="mini-terminal-body">
                            <div class="log-info">[INFO] 正在產生網頁列表...</div>
                            <div class="log-info">[INFO] 已處理 50 個影片</div>
                            <div class="log-warn">[WARN] 部分檔案缺少封面</div>
                            <div class="log-info">[INFO] 產生完成</div>
                        </div>
                        <div class="progress-mini">
                            <div style="width: 80%; height: 100%; background: linear-gradient(90deg, #3b82f6, #60a5fa); border-radius: 2px;"></div>
                        </div>
                    </div>
                </div>
                <pre class="ds-code"><code>.mini-terminal {
  background: #1a1a2e;
  border-radius: 12px;
  overflow: hidden;
}
.mini-terminal-body {
  font-family: 'SF Mono', 'Fira Code', monospace;
  font-size: 0.75rem;
  color: #d4d4d4;
}</code></pre>
            </div>

            <!-- Batch Progress Bar -->
            <div class="ds-subsection">
                <h3>Batch Progress Bar</h3>
                <p class="ds-desc">批次處理進度條，與 detail-progress 風格統一（藍色漸層）</p>
                <div class="ds-card-demo">
                    <div class="batch-progress" style="max-width: 400px;">
                        <div class="batch-progress-bar">
                            <div class="batch-progress-fill" style="width: 40%;"></div>
                        </div>
                        <small class="batch-progress-text">處理中 4/10</small>
                    </div>
                    <div class="batch-progress" style="max-width: 400px;">
                        <div class="batch-progress-bar">
                            <div class="batch-progress-fill" style="width: 75%;"></div>
                        </div>
                        <small class="batch-progress-text">處理中 15/20</small>
                    </div>
                </div>
                <pre class="ds-code"><code>.batch-progress-fill {
  height: 100%;
  background: linear-gradient(90deg,
    var(--progress-gradient-start),
    var(--progress-gradient-end));
  transition: var(--progress-transition);
}</code></pre>
            </div>

            <!-- Collapse Toggle -->
            <div class="ds-subsection">
                <h3>Collapse Toggle</h3>
                <p class="ds-desc">展開/收起連結，使用 Alpine.js，Chevron icon 旋轉動畫</p>
                <div class="ds-card-demo">
                    <div style="max-width: 400px; padding: 1rem; background: var(--bg-card); border-radius: 12px;">
                        <div x-data="{ expanded: false }">
                            <a class="collapse-toggle text-decoration-none"
                               @click="expanded = !expanded"
                               :aria-expanded="expanded"
                               role="button"
                               style="display: inline-flex; align-items: center; gap: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; cursor: pointer;">
                                <i class="bi bi-chevron-down" :class="{ 'rotate-180': expanded }"></i> 進階選項
                            </a>
                            <div x-show="expanded" x-collapse style="margin-top: 1rem; padding: 1rem; background: var(--bg-body); border-radius: 8px;">
                                <p style="margin: 0; color: var(--text-secondary);">這裡是展開後的內容區域</p>
                            </div>
                        </div>
                    </div>
                </div>
                <pre class="ds-code"><code>&lt;div x-data="{ expanded: false }"&gt;
  &lt;a class="collapse-toggle"
     @click="expanded = !expanded"&gt;
    &lt;i class="bi bi-chevron-down"
       :class="{ 'rotate-180': expanded }"&gt;&lt;/i&gt;
    進階選項
  &lt;/a&gt;
  &lt;div x-show="expanded" x-collapse&gt;
    內容...
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
            </div>
        </section>

        <!-- 區塊 9: Navigation (glass 樣式) -->
        <section id="navigation" class="ds-section glass">
            <h2>Navigation</h2>

            <div class="ds-subsection">
                <h3>Sidebar (Mini Demo)</h3>
                <div class="ds-sidebar-demo">
                    <nav class="ds-sidebar-mini">
                        <a class="nav-link active"><i class="bi bi-search"></i> 搜尋</a>
                        <a class="nav-link"><i class="bi bi-list-ul"></i> 列表生成</a>
                        <a class="nav-link"><i class="bi bi-collection-play"></i> 瀏覽</a>
                        <a class="nav-link"><i class="bi bi-gear"></i> 設定</a>
                    </nav>
                </div>
            </div>

            <div class="ds-subsection">
                <h3>Tabs (DaisyUI)</h3>
                <div class="alert alert-warning" role="alert" style="margin-bottom: 1rem; padding: 0.5rem 0.75rem;">
                    <i class="bi bi-exclamation-triangle"></i> <strong>未實際使用</strong> - 此元件目前未在專案中使用
                </div>
                <div class="tabs tabs-bordered">
                    <a class="tab tab-active">Tab 1</a>
                    <a class="tab">Tab 2</a>
                    <a class="tab">Tab 3</a>
                </div>
            </div>
        </section>

        <!-- 區塊 10: Rotating Border Effect (accent-bar 樣式) -->
        <section id="rotating-border" class="ds-section accent-bar">
            <h2>Rotating Border Effect</h2>
            <p class="ds-note">單光點旋轉外框特效，用於指示「有本地匹配」或「有內容」狀態</p>

            <!-- 基礎展示 -->
            <div class="ds-subsection">
                <h3>Basic Usage</h3>
                <p class="ds-desc">為元素添加 <code>.rotating-border-spotlight</code> class，並用 <code>.active</code> 啟用旋轉</p>
                <div class="ds-card-demo">
                    <div class="d-flex gap-3 flex-wrap align-items-center">
                        <!-- Inactive 狀態 -->
                        <div class="rotating-border-spotlight"
                             style="padding: 1.5rem 2rem; background: var(--bg-card); border-radius: var(--radius-md);">
                            <h5 style="margin: 0; color: var(--text-primary);">Inactive State</h5>
                            <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); font-size: 0.875rem;">沒有旋轉效果</p>
                        </div>

                        <!-- Active 狀態 -->
                        <div class="rotating-border-spotlight active"
                             style="padding: 1.5rem 2rem; background: var(--bg-card); border-radius: var(--radius-md);">
                            <h5 style="margin: 0; color: var(--text-primary);">Active State</h5>
                            <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); font-size: 0.875rem;">正在旋轉</p>
                        </div>
                    </div>
                </div>
                <pre class="ds-code"><code>&lt;div class="rotating-border-spotlight active"&gt;
  &lt;!-- 內容 --&gt;
&lt;/div&gt;</code></pre>
            </div>

            <!-- 應用場景 -->
            <div class="ds-subsection">
                <h3>Use Cases</h3>
                <p class="ds-desc">實際應用場景展示</p>

                <!-- 場景 1: Card -->
                <h4 style="margin-top: 1.5rem; margin-bottom: 1rem; font-size: 1rem; font-weight: 600;">1. Card with Local Match</h4>
                <div class="ds-card-demo">
                    <div class="rotating-border-spotlight active"
                         style="max-width: 280px; background: var(--bg-card); border-radius: var(--fluent-radius-xl, 12px); overflow: hidden; box-shadow: var(--fluent-shadow-4);">
                        <div style="aspect-ratio: 16/9; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); position: relative;">
                            <img src="/static/img/demo/sone-103.jpg" alt="cover" style="width: 100%; height: 100%; object-fit: cover;">
                            <span style="position: absolute; top: 0.5rem; right: 0.5rem; background: rgba(90, 200, 250, 0.9); color: #fff; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">本地</span>
                        </div>
                        <div style="padding: 1rem;">
                            <div style="font-weight: 600; color: var(--accent); margin-bottom: 0.25rem;">SONE-103</div>
                            <div style="font-size: 0.875rem; color: var(--text-secondary);">2024-01-15</div>
                        </div>
                    </div>
                </div>

                <!-- 場景 2: Navigation Link -->
                <h4 style="margin-top: 1.5rem; margin-bottom: 1rem; font-size: 1rem; font-weight: 600;">2. Sidebar Navigation Link</h4>
                <div class="ds-card-demo">
                    <div style="background: var(--bg-sidebar); padding: 1rem; border-radius: var(--radius-md); max-width: 200px;">
                        <nav style="display: flex; flex-direction: column; gap: 0.25rem;">
                            <a class="nav-link" href="#" style="color: rgba(255, 255, 255, 0.8); padding: 0.75rem; border-radius: 0.25rem; display: flex; align-items: center; text-decoration: none;">
                                <i class="bi bi-search" style="width: 24px;"></i>
                                <span style="margin-left: 0.5rem;">搜尋</span>
                            </a>
                            <a class="nav-link rotating-border-spotlight active" href="#" style="color: rgba(255, 255, 255, 0.8); padding: 0.75rem; border-radius: 0.25rem; display: flex; align-items: center; text-decoration: none; background-color: rgba(255, 255, 255, 0.1);">
                                <i class="bi bi-collection-play" style="width: 24px;"></i>
                                <span style="margin-left: 0.5rem;">瀏覽 (有內容)</span>
                            </a>
                            <a class="nav-link" href="#" style="color: rgba(255, 255, 255, 0.8); padding: 0.75rem; border-radius: 0.25rem; display: flex; align-items: center; text-decoration: none;">
                                <i class="bi bi-gear" style="width: 24px;"></i>
                                <span style="margin-left: 0.5rem;">設定</span>
                            </a>
                        </nav>
                    </div>
                </div>

                <!-- 場景 3: Info Section -->
                <h4 style="margin-top: 1.5rem; margin-bottom: 1rem; font-size: 1rem; font-weight: 600;">3. Search Result Info Section</h4>
                <div class="ds-card-demo">
                    <div class="rotating-border-spotlight active"
                         style="max-width: 600px; background: var(--bg-card); border-radius: var(--radius-md); padding: 1.5rem; box-shadow: var(--fluent-shadow-4);">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                            <i class="bi bi-folder-check" style="font-size: 1.5rem; color: var(--accent);"></i>
                            <h4 style="margin: 0; font-size: 1.125rem; font-weight: 600; color: var(--text-primary);">本地資料庫匹配</h4>
                        </div>
                        <div style="padding-left: 2.25rem;">
                            <div style="margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">
                                <span style="color: var(--text-primary); font-weight: 600;">檔案：</span>
                                /Users/username/Videos/SONE-103.mp4
                            </div>
                            <div style="color: var(--text-secondary); font-size: 0.875rem;">
                                <span style="color: var(--text-primary); font-weight: 600;">大小：</span>
                                2.4 GB
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 技術規格 -->
            <div class="ds-subsection">
                <h3>Technical Specs</h3>
                <div class="ds-card-demo">
                    <table class="table table-sm" style="max-width: 600px; margin: 0;">
                        <tbody>
                            <tr>
                                <td style="width: 30%; font-weight: 600; color: var(--text-primary);">旋轉速度</td>
                                <td style="color: var(--text-secondary);">2.5 秒/圈</td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600; color: var(--text-primary);">光點角度</td>
                                <td style="color: var(--text-secondary);">30° 核心 + 30° 拖尾 = 60° 總長</td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600; color: var(--text-primary);">Light Mode 透明度</td>
                                <td style="color: var(--text-secondary);">0.6 (核心) / 0.3 (拖尾)</td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600; color: var(--text-primary);">Dark Mode 透明度</td>
                                <td style="color: var(--text-secondary);">0.7 (核心) / 0.4 (拖尾)</td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600; color: var(--text-primary);">顏色來源</td>
                                <td style="color: var(--text-secondary);">延續 <code>--accent</code> 藍色系</td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600; color: var(--text-primary);">瀏覽器支援</td>
                                <td style="color: var(--text-secondary);">Chrome 85+, Edge 85+, Safari 15.4+, Firefox 128+</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 變體選項 -->
            <div class="ds-subsection">
                <h3>Speed Variants (Optional)</h3>
                <p class="ds-desc">可選的速度變體，用於不同強調程度</p>
                <div class="ds-card-demo">
                    <div class="d-flex gap-3 flex-wrap">
                        <div class="rotating-border-spotlight speed-slow active"
                             style="padding: 1rem 1.5rem; background: var(--bg-card); border-radius: var(--radius-md);">
                            <small style="color: var(--text-muted);">Slow (4s)</small>
                        </div>
                        <div class="rotating-border-spotlight active"
                             style="padding: 1rem 1.5rem; background: var(--bg-card); border-radius: var(--radius-md);">
                            <small style="color: var(--text-muted);">Normal (2.5s)</small>
                        </div>
                        <div class="rotating-border-spotlight speed-fast active"
                             style="padding: 1rem 1.5rem; background: var(--bg-card); border-radius: var(--radius-md);">
                            <small style="color: var(--text-muted);">Fast (1.5s)</small>
                        </div>
                    </div>
                </div>
                <pre class="ds-code"><code>&lt;!-- 慢速旋轉 --&gt;
&lt;div class="rotating-border-spotlight speed-slow active"&gt;...&lt;/div&gt;

&lt;!-- 快速旋轉 --&gt;
&lt;div class="rotating-border-spotlight speed-fast active"&gt;...&lt;/div&gt;</code></pre>
            </div>

            <!-- 無障礙與降級 -->
            <div class="ds-subsection">
                <h3>Accessibility & Fallback</h3>
                <div class="alert alert-info" role="alert" style="margin-bottom: 1rem;">
                    <i class="bi bi-info-circle"></i> <strong>prefers-reduced-motion</strong>：尊重使用者偏好，停用動畫改為靜態發光邊框
                </div>
                <div class="alert alert-warning" role="alert">
                    <i class="bi bi-exclamation-triangle"></i> <strong>瀏覽器降級</strong>：不支援 <code>conic-gradient</code> 時降級為靜態 <code>box-shadow</code> 邊框
                </div>
            </div>
        </section>

        <!-- 區塊 11: Feedback (glass 樣式) -->
        <section id="feedback" class="ds-section glass">
            <h2>Feedback</h2>

            <div class="ds-subsection">
                <h3>Alert / Badge</h3>
                <div class="ds-feedback-row">
                    <div class="alert alert-warning" role="alert">
                        <i class="bi bi-exclamation-triangle"></i> 警告訊息
                    </div>
                    <span class="badge bg-primary">Badge</span>
                    <span class="badge bg-danger">錯誤</span>
                    <span class="badge bg-success">成功</span>
                </div>
            </div>

            <div class="ds-subsection">
                <h3>Toast</h3>
                <div class="ds-toast-demo">
                    <div class="toast-msg show">這是一個 Toast 訊息</div>
                </div>
                <div class="ds-toast-demo">
                    <div class="source-toast-inline show">已複製</div>
                </div>
            </div>

            <div class="ds-subsection">
                <h3>Progress Bar</h3>
                <div class="ds-progress-demo">
                    <div class="detail-progress show" style="position: relative;">
                        <div class="detail-bar" style="width: 65%;"></div>
                        <span class="detail-text">65 / 100</span>
                    </div>
                </div>
                <div class="ds-progress-demo">
                    <div class="batch-progress">
                        <div class="batch-progress-bar">
                            <div class="batch-progress-fill" style="width: 40%;"></div>
                        </div>
                        <small class="batch-progress-text">處理中 4/10</small>
                    </div>
                </div>
            </div>

            <div class="ds-subsection">
                <h3>Spinner</h3>
                <div class="ds-feedback-row">
                    <span class="spinner-border spinner-border-sm"></span>
                    <span class="spinner-border"></span>
                    <button class="btn btn-primary" disabled>
                        <span class="spinner-border spinner-border-sm"></span> 載入中...
                    </button>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- TOC Active State Script + Dynamic Color Hex -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // TOC Active State
    const tocLinks = document.querySelectorAll('.ds-toc a');
    const sections = document.querySelectorAll('.ds-section');

    function updateActiveLink() {
        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            if (window.scrollY >= sectionTop - 100) {
                current = section.getAttribute('id');
            }
        });

        tocLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + current) {
                link.classList.add('active');
            }
        });
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();

    // Dynamic Color Hex Values
    function rgbToHex(rgb) {
        // Handle rgb(r, g, b), rgb(r g b), rgba(r, g, b, a), rgba(r g b / a)
        const match = rgb.match(/rgba?\((\d+)[,\s]+(\d+)[,\s]+(\d+)/);
        if (match) {
            const r = parseInt(match[1]).toString(16).padStart(2, '0');
            const g = parseInt(match[2]).toString(16).padStart(2, '0');
            const b = parseInt(match[3]).toString(16).padStart(2, '0');
            return `#${r}${g}${b}`;
        }
        // Already hex or other format, return as-is
        return rgb;
    }

    function updateColorHex() {
        const style = getComputedStyle(document.documentElement);
        document.querySelectorAll('.ds-color-hex[data-var]').forEach(el => {
            const varName = el.dataset.var;
            const value = style.getPropertyValue(varName).trim();
            // Convert rgb to hex if needed
            el.textContent = value.startsWith('rgb') ? rgbToHex(value) : value;
        });
    }

    // Initial update
    updateColorHex();

    // Watch for theme changes via MutationObserver on html element
    const htmlEl = document.documentElement;
    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            if (mutation.attributeName === 'data-theme') {
                // Delay to let CSS variables update
                setTimeout(updateColorHex, 50);
            }
        });
    });
    observer.observe(htmlEl, { attributes: true, attributeFilter: ['data-theme'] });
});
</script>
{% endblock %}
